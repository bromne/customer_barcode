<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>料金受取人払郵便物用　カスタマバーコード作成</title>
</head>
<BODY BGCOLOR="white">
<script language="JavaScript">
<!-- 
function Button()
{
	Bar = new Array(30);
	M = new Array(30);
	if (document.CBFORM.YNO.value == "") {
		alert("郵便番号を入力してください");
		return;
	}

	if (document.CBFORM.YNO.value.length != 7) {
		alert("郵便番号には、半角数字７桁で入力してください。");
		return;
	}

	for(i=0;i<7;i++) {
		Bar[i] = document.CBFORM.YNO.value.charAt(i);
		if (Bar[i] < "0" || Bar[i] > "9") {
			alert("郵便番号には、半角数字７桁で入力してください。");
			return;
		}
	}

	for(i=7;i<20;i++) {
		Bar[i] = document.CBFORM.ZNO.value.charAt(i - 7);
		if (Bar[i] == "") Bar[i] = " ";
		if ((Bar[i] < "0" || Bar[i] > "9") && (Bar[i] < "A" || Bar[i] > "Z") && (Bar[i] != " ") && (Bar[i] != "-")) {
			alert("整理番号は、半角数字１〜９,半角大文字Ａ〜Ｚ,半角ハイフンが使用できる文字です。");
			return;
		}
		if (Bar[i-1] == " " &&  Bar[i] != " ") {
			alert("整理番号に不正な文字が含まれています");
			return;
		}
	}

	Deg = 0;
	j = 1;
	M[0] = "S.GIF";
	M[22] = "E.GIF";

	for(i=0;i<20;i++) {
		if ((Bar[i] >= "0" && Bar[i] <= "9") || Bar[i] == "-") {
			M[j++] = Bar[i] + ".GIF";
			if (Bar[i] == "-") {
				Deg = Deg + 10;
			}
			else {
				Deg = Deg + parseInt(Bar[i]);
			}
		}
		else {
			if (Bar[i] == " ") {
				M[j++] = "C4.GIF";
				Deg = Deg + 14;
			}
			if (j < 20) {
				if (Bar[i] == "A") {
					M[j++] = "C1.GIF";
					Deg = Deg + 11;
					M[j++] = "0.GIF";
					Deg = Deg + 0;
				}
				if (Bar[i] == "B") {
					M[j++] = "C1.GIF";
					Deg = Deg + 11;
					M[j++] = "1.GIF";
					Deg = Deg + 1;
				}
				if (Bar[i] == "C") {
					M[j++] = "C1.GIF";
					Deg = Deg + 11;
					M[j++] = "2.GIF";
					Deg = Deg + 2;
				}
				if (Bar[i] == "D") {
					M[j++] = "C1.GIF";
					Deg = Deg + 11;
					M[j++] = "3.GIF";
					Deg = Deg + 3;
				}
				if (Bar[i] == "E") {
					M[j++] = "C1.GIF";
					Deg = Deg + 11;
					M[j++] = "4.GIF";
					Deg = Deg + 4;
				}
				if (Bar[i] == "F") {
					M[j++] = "C1.GIF";
					Deg = Deg + 11;
					M[j++] = "5.GIF";
					Deg = Deg + 5;
				}
				if (Bar[i] == "G") {
					M[j++] = "C1.GIF";
					Deg = Deg + 11;
					M[j++] = "6.GIF";
					Deg = Deg + 6;
				}
				if (Bar[i] == "H") {
					M[j++] = "C1.GIF";
					Deg = Deg + 11;
					M[j++] = "7.GIF";
					Deg = Deg + 7;
				}
				if (Bar[i] == "I") {
					M[j++] = "C1.GIF";
					Deg = Deg + 11;
					M[j++] = "8.GIF";
					Deg = Deg + 8;
				}
				if (Bar[i] == "J") {
					M[j++] = "C1.GIF";
					Deg = Deg + 11;
					M[j++] = "9.GIF";
					Deg = Deg + 9;
				}
				if (Bar[i] == "K") {
					M[j++] = "C2.GIF";
					Deg = Deg + 12;
					M[j++] = "0.GIF";
					Deg = Deg + 0;
				}
				if (Bar[i] == "L") {
					M[j++] = "C2.GIF";
					Deg = Deg + 12;
					M[j++] = "1.GIF";
					Deg = Deg + 1;
				}
				if (Bar[i] == "M") {
					M[j++] = "C2.GIF";
					Deg = Deg + 12;
					M[j++] = "2.GIF";
					Deg = Deg + 2;
				}
				if (Bar[i] == "N") {
					M[j++] = "C2.GIF";
					Deg = Deg + 12;
					M[j++] = "3.GIF";
					Deg = Deg + 3;
				}
				if (Bar[i] == "O") {
					M[j++] = "C2.GIF";
					Deg = Deg + 12;
					M[j++] = "4.GIF";
					Deg = Deg + 4;
				}
				if (Bar[i] == "P") {
					M[j++] = "C2.GIF";
					Deg = Deg + 12;
					M[j++] = "5.GIF";
					Deg = Deg + 5;
				}
				if (Bar[i] == "Q") {
					M[j++] = "C2.GIF";
					Deg = Deg + 12;
					M[j++] = "6.GIF";
					Deg = Deg + 6;
				}
				if (Bar[i] == "R") {
					M[j++] = "C2.GIF";
					Deg = Deg + 12;
					M[j++] = "7.GIF";
					Deg = Deg + 7;
				}
				if (Bar[i] == "S") {
					M[j++] = "C2.GIF";
					Deg = Deg + 12;
					M[j++] = "8.GIF";
					Deg = Deg + 8;
				}
				if (Bar[i] == "T") {
					M[j++] = "C2.GIF";
					Deg = Deg + 12;
					M[j++] = "9.GIF";
					Deg = Deg + 9;
				}
				if (Bar[i] == "U") {
					M[j++] = "C3.GIF";
					Deg = Deg + 13;
					M[j++] = "0.GIF";
					Deg = Deg + 0;
				}
				if (Bar[i] == "V") {
					M[j++] = "C3.GIF";
					Deg = Deg + 13;
					M[j++] = "1.GIF";
					Deg = Deg + 1;
				}
				if (Bar[i] == "W") {
					M[j++] = "C3.GIF";
					Deg = Deg + 13;
					M[j++] = "2.GIF";
					Deg = Deg + 2;
				}
				if (Bar[i] == "X") {
					M[j++] = "C3.GIF";
					Deg = Deg + 13;
					M[j++] = "3.GIF";
					Deg = Deg + 3;
				}
				if (Bar[i] == "Y") {
					M[j++] = "C3.GIF";
					Deg = Deg + 13;
					M[j++] = "4.GIF";
					Deg = Deg + 4;
				}
				if (Bar[i] == "Z") {
					M[j++] = "C3.GIF";
					Deg = Deg + 13;
					M[j++] = "5.GIF";
					Deg = Deg + 5;
				}
			}
//Z まで
			else {
				if (j <= 20) {
					M[j++] = "C4.GIF";
					Deg = Deg + 14;
				}
			}
		}
		if (j > 20) break;
	}
//Deg
	if ((Deg % 19) == 0) {
		Cdeg = 0;
	}
	else {
		Cdeg = (19 - (Deg % 19));
	}

	if (Cdeg == 0) {
		M[21] = "0.GIF";
	}
	if (Cdeg == 1) {
		M[21] = "1.GIF";
	}
	if (Cdeg == 2) {
		M[21] = "2.GIF";
	}
	if (Cdeg == 3) {
		M[21] = "3.GIF";
	}
	if (Cdeg == 4) {
		M[21] = "4.GIF";
	}
	if (Cdeg == 5) {
		M[21] = "5.GIF";
	}
	if (Cdeg == 6) {
		M[21] = "6.GIF";
	}
	if (Cdeg == 7) {
		M[21] = "7.GIF";
	}
	if (Cdeg == 8) {
		M[21] = "8.GIF";
	}
	if (Cdeg == 9) {
		M[21] = "9.GIF";
	}
	if (Cdeg == 10) {
		M[21] = "-.GIF";
	}
	if (Cdeg == 11) {
		M[21] = "C1.GIF";
	}
	if (Cdeg == 12) {
		M[21] = "C2.GIF";
	}
	if (Cdeg == 13) {
		M[21] = "C3.GIF";
	}
	if (Cdeg == 14) {
		M[21] = "C4.GIF";
	}
	if (Cdeg == 15) {
		M[21] = "C5.GIF";
	}
	if (Cdeg == 16) {
		M[21] = "C6.GIF";
	}
	if (Cdeg == 17) {
		M[21] = "C7.GIF";
	}
	if (Cdeg == 18) {
		M[21] = "C8.GIF";
	}
	
	newWin = window.open("","CBC");
	newWin.document.open();
	newWin.document.write("<HTML>");
	newWin.document.write("<HEAD>");
	newWin.document.write("<TITLE>料金受取人払郵便物用カスタマバーコード表示　</TITLE>");
	newWin.document.write("</HEAD>");
	newWin.document.write('<BODY BGCOLOR="white">');
	newWin.document.write("<CENTER><H2>料金受取人払郵便物用カスタマバーコード表示　</H2></CENTER>");
	newWin.document.write("<H3>注意　バーコードデータが表示されない場合はリロード（再読込、更新など）してください。<BR>　ブラウザの終了で前のページに戻れます。</H3>");
	newWin.document.write("<P></P>");
	newWin.document.write("<H>入力したデータ（",document.CBFORM.YNO.value," ",document.CBFORM.ZNO.value,"）のカスタマバーコードは以下のようになります。</H>");
	newWin.document.write("<P></P>");
	newWin.document.write("<H>［実寸］9.1ポイント相当（プリンタにより拡大される場合は、バーコードの端から端までが64mm〜88mmの範囲となるよう縮小等して下さい。）</H>");
	newWin.document.write("<P></P>");
	newWin.document.write('<IMG SRC="',M[0],'"><IMG SRC="',M[1],'"><IMG SRC="',M[2],'"><IMG SRC="',M[3],'"><IMG SRC="',M[4],'"><IMG SRC="',M[5],'"><IMG SRC="',M[6],'"><IMG SRC="',M[7],'"><IMG SRC="',M[8],'"><IMG SRC="',M[9],'"><IMG SRC="',M[10],'"><IMG SRC="',M[11],'"><IMG SRC="',M[12],'"><IMG SRC="',M[13],'"><IMG SRC="',M[14],'"><IMG SRC="',M[15],'"><IMG SRC="',M[16],'"><IMG SRC="',M[17],'"><IMG SRC="',M[18],'"><IMG SRC="',M[19],'"><IMG SRC="',M[20],'"><IMG SRC="',M[21],'"><IMG SRC="',M[22],'">');
	newWin.document.write("<P></P>");

//拡大
	if (document.CBFORM.BIG.checked == true) {
		newWin.document.write("<H>［拡大］実際に使用する場合は、バーコードの長さが64mm〜88mmとなる範囲内で縮小してください。</H>");
		newWin.document.write("<P></P>");
		newWin.document.write('<IMG SRC="',M[0],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[1],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[2],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[3],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[4],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[5],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[6],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[7],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[8],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[9],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[10],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[11],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[12],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[13],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[14],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[15],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[16],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[17],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[18],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[19],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[20],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[21],'" WIDTH="18" HEIGHT="18"><IMG SRC="',M[22],'" WIDTH="18" HEIGHT="18">');
		newWin.document.write("<P></P>");
	}

//構成表
	if (document.CBFORM.KOU.checked == true) {
		newWin.document.write("<TABLE BORDER>");
		newWin.document.write("<CAPTION ALIGN=CENTER>＜構　　成＞</CAPTION>");
		newWin.document.write("<TR><TH COLSPAN=1></TH><TH COLSPAN=1>スタート</TH><TH COLSPAN=7>郵便番号</TH><TH COLSPAN=13>整理番号</TH><TH COLSPAN=1>チェックデジット</TH><TH COLSPAN=1>エンド</TH></TR>");
		newWin.document.write("<TR><TD>バーコードの位置</TD><TD>1</TD><TD>2</TD><TD>3</TD><TD>4</TD><TD>5</TD><TD>6</TD><TD>7</TD><TD>8</TD><TD>9</TD><TD>10</TD><TD>11</TD><TD>12</TD><TD>13</TD><TD>14</TD><TD>15</TD><TD>16</TD><TD>17</TD><TD>18</TD><TD>19</TD><TD>20</TD><TD>21</TD><TD>22</TD><TD>23</TD></TR>");
		newWin.document.write("</TR><TD>バーコードのデータ</TD><TD>",M[0],"</TD><TD>",M[1],"</TD><TD>",M[2],"</TD><TD>",M[3],"</TD><TD>",M[4],"</TD><TD>",M[5],"</TD><TD>",M[6],"</TD><TD>",M[7],"</TD><TD>",M[8],"</TD><TD>",M[9],"</TD><TD>",M[10],"</TD><TD>",M[11],"</TD><TD>",M[12],"</TD><TD>",M[13],"</TD><TD>",M[14],"</TD><TD>",M[15],"</TD><TD>",M[16],"</TD><TD>",M[17],"</TD><TD>",M[18],"</TD><TD>",M[19],"</TD><TD>",M[20],"</TD><TD>",M[21],"</TD><TD>",M[22],"</TD></TR>");
		newWin.document.write("</TABLE>");
		newWin.document.write("<P></P>");
	}
	newWin.document.write('<IMG SRC="SETUMEI.GIF">');
	newWin.document.write("</BODY>");
	newWin.document.write("</HTML>");
	newWin.document.close();
}
//-->
</SCRIPT >

<CENTER><H2>料金受取人払郵便物用　カスタマバーコードデータ入力</H2></CENTER>
<FORM NAME="CBFORM">
<P>
<H3><FONT COLOR="RED">このページにより作成されたバーコードは、ご使用のパソコン・プリンタの組み合わせにより、適切に印字されないことがあります。<br>
実際に使用される用紙等に試し刷りをし、最寄の支店でチェックを受けたのち、郵便物の印刷を行って下さい。</FONT></H3>
</P>
<P>
<H>郵便番号（７桁）</H><INPUT TYPE="TEXT" NAME="YNO" SIZE="15" MAXLENGTH="7">
<H>　　整理番号</H><INPUT TYPE="TEXT" NAME="ZNO" SIZE="25" MAXLENGTH="13">
</P>
<P>
<INPUT TYPE="CHECKBOX" NAME="BIG"><H>１．５倍に拡大したバーコードをあわせて表示します。</H>
</P>
<P>
<INPUT TYPE="CHECKBOX" NAME="KOU"><H>バーコードの構成表をあわせて表示します。</H>
</P>
<P>
<INPUT TYPE="BUTTON" NAME="Bt" VALUE="開始" onClick="Button()">
</P>
<P>
<H3>【操作方法】<BR><BR></H3>
<H>１．バーコード情報入力<BR></H>
<H>　(1) 個別番号の場合<BR></H>
<H>　　ア　郵便番号<BR></H>
<H>　　　　７桁の郵便番号を入力してください。<BR></H>
<H>　　イ　整理番号<BR></H>
<H>　　　　入力しないでください。<BR></H>
<H>　(2) 包括番号の場合<BR></H>
<H>　　ア　郵便番号<BR></H>
<H>　　　　７桁の郵便番号を入力してください。<BR></H>
<H>　　イ　整理番号<BR></H>
<H>　　　　３桁の整理番号を入力してください。<BR><BR></H>
<H>２．カスタマバーコードの作成<BR></H>
<H>　　バーコード情報を入力後［開始］ボタンを押してください。新規のブラウザを起動し、カスタマバーコードが表示されます。<BR><BR></H>
<H>３．ワープロソフトなどへの取り込み<BR></H>
<H>　表示されるカスタマバーコードは、一文字づつのバーコードデータ（ＧＩＦ形式）を並べて表示しています。このため、通常のブラウザでは、カット＆ペーストが上手くできません。スクリーンを切り出せるツールの使用や、画面のハードコピーをペイントブラシに貼り付けて編集する方法や、ファイル（ＧＩＦ）を一文字づつ並べる方法などの対応にてお願いします。（バーコードの並びを知るには、「バーコードの構成表をあわせて表示します。」をチェックしてください。）<BR><BR></H>
<H>　　表示画面を終了させる場合は、ブラウザの終了を行ってください。<BR><BR></H>
<H3>注意！　表示画面にてバーコードデータが表示されない場合は<FONT COLOR="#ff0000"><B>リロード（再読込、更新など）</B></FONT>をしてください。<BR></H3>
</P>
</BODY>
</HTML>
